!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@donkeyclip/motorcortex")):"function"==typeof define&&define.amd?define(["@donkeyclip/motorcortex"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["@kissmybutton/motorcortex-youtube"]=e(t.MotorCortex)}(this,(function(t){"use strict";var e,n,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=function(t){try{return!!t()}catch(t){return!0}},i=!o((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),u=Function.prototype,a=u.bind,s=u.call,c=a&&a.bind(s),l=a?function(t){return t&&c(s,t)}:function(t){return t&&function(){return s.apply(t,arguments)}},f=function(t){return t&&t.Math==Math&&t},y=f("object"==typeof globalThis&&globalThis)||f("object"==typeof window&&window)||f("object"==typeof self&&self)||f("object"==typeof r&&r)||function(){return this}()||Function("return this")(),p=y.TypeError,d=function(t){if(null==t)throw p("Can't call method on "+t);return t},h=y.Object,b=function(t){return h(d(t))},m=l({}.hasOwnProperty),v=Object.hasOwn||function(t,e){return m(b(t),e)},g=i,w=v,j=Function.prototype,O=g&&Object.getOwnPropertyDescriptor,k=w(j,"name"),S={EXISTS:k,PROPER:k&&"something"===function(){}.name,CONFIGURABLE:k&&(!g||g&&O(j,"name").configurable)},P={},x=function(t){return"function"==typeof t},T=x,E=function(t){return"object"==typeof t?null!==t:T(t)},_=E,C=y.document,F=_(C)&&_(C.createElement),V=function(t){return F?C.createElement(t):{}},R=!i&&!o((function(){return 7!=Object.defineProperty(V("div"),"a",{get:function(){return 7}}).a})),I=y,L=E,A=I.String,B=I.TypeError,D=Function.prototype.call,H=D.bind?D.bind(D):function(){return D.apply(D,arguments)},M=y,X=x,Y=function(t){return X(t)?t:void 0},q=function(t,e){return arguments.length<2?Y(M[t]):M[t]&&M[t][e]},z=l({}.isPrototypeOf),G=y,N=q("navigator","userAgent")||"",U=G.process,J=G.Deno,K=U&&U.versions||J&&J.version,Q=K&&K.v8;Q&&(n=(e=Q.split("."))[0]>0&&e[0]<4?1:+(e[0]+e[1])),!n&&N&&(!(e=N.match(/Edge\/(\d+)/))||e[1]>=74)&&(e=N.match(/Chrome\/(\d+)/))&&(n=+e[1]);var W=n,Z=o,$=!!Object.getOwnPropertySymbols&&!Z((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&W&&W<41})),tt=$&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,et=q,nt=x,rt=z,ot=tt,it=y.Object,ut=ot?function(t){return"symbol"==typeof t}:function(t){var e=et("Symbol");return nt(e)&&rt(e.prototype,it(t))},at=y.String,st=x,ct=function(t){try{return at(t)}catch(t){return"Object"}},lt=y.TypeError,ft=function(t){if(st(t))return t;throw lt(ct(t)+" is not a function")},yt=H,pt=x,dt=E,ht=y.TypeError,bt={exports:{}},mt=y,vt=Object.defineProperty,gt=function(t,e){try{vt(mt,t,{value:e,configurable:!0,writable:!0})}catch(n){mt[t]=e}return e},wt="__core-js_shared__",jt=y[wt]||gt(wt,{});(bt.exports=function(t,e){return jt[t]||(jt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.19.0",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"});var Ot=l,kt=0,St=Math.random(),Pt=Ot(1..toString),xt=y,Tt=bt.exports,Et=v,_t=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Pt(++kt+St,36)},Ct=$,Ft=tt,Vt=Tt("wks"),Rt=xt.Symbol,It=Rt&&Rt.for,Lt=Ft?Rt:Rt&&Rt.withoutSetter||_t,At=H,Bt=E,Dt=ut,Ht=function(t,e){var n=t[e];return null==n?void 0:ft(n)},Mt=function(t,e){var n,r;if("string"===e&&pt(n=t.toString)&&!dt(r=yt(n,t)))return r;if(pt(n=t.valueOf)&&!dt(r=yt(n,t)))return r;if("string"!==e&&pt(n=t.toString)&&!dt(r=yt(n,t)))return r;throw ht("Can't convert object to primitive value")},Xt=function(t){if(!Et(Vt,t)||!Ct&&"string"!=typeof Vt[t]){var e="Symbol."+t;Ct&&Et(Rt,t)?Vt[t]=Rt[t]:Vt[t]=Ft&&It?It(e):Lt(e)}return Vt[t]},Yt=y.TypeError,qt=Xt("toPrimitive"),zt=function(t,e){if(!Bt(t)||Dt(t))return t;var n,r=Ht(t,qt);if(r){if(void 0===e&&(e="default"),n=At(r,t,e),!Bt(n)||Dt(n))return n;throw Yt("Can't convert object to primitive value")}return void 0===e&&(e="number"),Mt(t,e)},Gt=ut,Nt=i,Ut=R,Jt=function(t){if(L(t))return t;throw B(A(t)+" is not an object")},Kt=function(t){var e=zt(t,"string");return Gt(e)?e:e+""},Qt=y.TypeError,Wt=Object.defineProperty;P.f=Nt?Wt:function(t,e,n){if(Jt(t),e=Kt(e),Jt(n),Ut)try{return Wt(t,e,n)}catch(t){}if("get"in n||"set"in n)throw Qt("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Zt=i,$t=S.EXISTS,te=l,ee=P.f,ne=Function.prototype,re=te(ne.toString),oe=/^\s*function ([^ (]*)/,ie=te(oe.exec);function ue(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ae(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function se(t,e,n){return e&&ae(t.prototype,e),n&&ae(t,n),t}function ce(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fe(t,e)}function le(t){return le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},le(t)}function fe(t,e){return fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},fe(t,e)}function ye(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function pe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=le(t);if(e){var o=le(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ye(this,n)}}Zt&&!$t&&ee(ne,"name",{configurable:!0,get:function(){try{return ie(oe,re(this))[1]}catch(t){return""}}});var de=function(t){ce(n,t);var e=pe(n);function n(){return ue(this,n),e.apply(this,arguments)}return se(n,[{key:"html",get:function(){return this.width=this.attrs.width||640,this.height=this.attrs.height||360,this.startFrom=this.attrs.startFrom||0,"\n      <div></div>\n    "}},{key:"css",get:function(){return"\n      #video{\n        display:none;\n      }\n    "}},{key:"subscribeVideoListener",value:function(t){this.subscribers||(this.subscribers=[]),this.subscribers.push(t)}},{key:"setVolume",value:function(t){this.entity.player.setVolume(100*t*(this.attrs.volume||1))}},{key:"onAfterRender",value:function(){var t=this;this.contextLoading();var e,n=this,r={player:e,startFrom:this.startFrom,loaded:!1,subscribeVideoListener:function(t){return n.subscribeVideoListener(t)}};this.entity=r,this.setCustomEntity("video",r);var o=this.context.document.createElement("script");o.src="https://www.youtube.com/iframe_api",this.context.rootElement.appendChild(o),window.onYouTubeIframeAPIReady=function(){e=new window.YT.Player(t.context.getElements("div")[0],{height:t.attrs.height,width:t.attrs.width,videoId:t.attrs.videoId,playerVars:{controls:0,playsinline:0,disablekb:1,enablejsapi:1,fs:0,iv_load_policy:3,modestbranding:1,rel:0,showinfo:0,ecver:2,start:t.startFrom/1e3},events:{onReady:function(){r.loaded=!0,r.player=e;var t=n.DescriptiveIncident.volumeChangeSubscribe(n.id,n.setVolume.bind(n));n.setVolume(t),n.contextLoaded()},onStateChange:function(t){if(n.subscribers)for(var e=0;e<n.subscribers.length;e++)n.subscribers[e](t.data)}}})}}}]),n}(t.BrowserClip),he=function(t){ce(n,t);var e=pe(n);function n(){return ue(this,n),e.apply(this,arguments)}return se(n,[{key:"onInitialise",value:function(){this.element.entity.subscribeVideoListener(this.stateChange.bind(this))}},{key:"play",value:function(t){var e=this.element.entity,n=e.player.getPlayerState();return-1===n||3===n?(e.player.seekTo((t+this.element.entity.startFrom)/1e3),e.player.playVideo(),this.waitingHandler()):(1!==n&&(e.player.seekTo((t+this.element.entity.startFrom)/1e3),e.player.playVideo()),!0)}},{key:"stateChange",value:function(t){switch(t){case 3:this.waitingHandler();break;case 1:this.canplayHandler()}}},{key:"waitingHandler",value:function(){this.setBlock("Video loading",{exceptional:!0})}},{key:"canplayHandler",value:function(){this.unblock()}},{key:"stop",value:function(){this.element.entity.player.pauseVideo()}},{key:"onProgress",value:function(t,e){var n=e+this.element.entity.startFrom;-1!==this.element.entity.player.getPlayerState()&&5!==this.element.entity.player.getPlayerState()||this.element.entity.player.pauseVideo(),this.element.entity.player.seekTo(n/1e3)}}]),n}(t.MediaPlayback);return{npm_name:"@kissmybutton/motorcortex-youtube",version:"1.0.0",incidents:[{exportable:he,name:"Playback"}],Clip:{exportable:de,attributesValidationRules:{width:{optional:!0,type:"number",integer:!0,positive:!0},height:{optional:!0,type:"number",integer:!0,positive:!0},startFrom:{optional:!0,type:"number",integer:!0,min:0},videoId:{type:"string"},volume:{type:"number",min:0,max:1,default:1}}},capabilities:{speed:!1,preview:!1},audio:"on"}}));
